import{_ as B,f as p,j as g,h as T,g as D,c as I,w as o,r as n,i as S,o as y,a as l,d as R,u as j,E as x,m as q}from"./index-CQa1UL8_.js";import{r as F}from"./request-B1Pnm9MM.js";const H={class:"login-register-container"},J={__name:"auth",setup(M){const i=p(!1),f=p("login"),U=j(),k=(m,e)=>{console.log(m,e)},u=g({email:"",password:""}),c=p(null),C=g({email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入有效的邮箱地址",trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:50,message:"长度在 6 到 50 个字符",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"blur"}]}),E=()=>{c.value&&c.value.validate(m=>{if(m)i.value=!0,F.post("https://login-fyoxpel6ba-uc.a.run.app",u).then(e=>{i.value=!1,console.log("登录成功:",e),localStorage.setItem("user_info",JSON.stringify(e)),x.success("登录成功"),U.push({name:"Home"})}).catch(e=>{i.value=!1,x.error("登录失败，请检查邮箱或密码"),console.error("登录失败:",e)});else return console.log("error submit!!"),!1})},a=g({email:"",password:"",confirmPassword:"",role:""}),_=p(null),P=g({email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入有效的邮箱地址",trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:50,message:"长度在 6 到 50 个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:(m,e,s)=>{e===""?s(new Error("请再次输入密码")):e!==a.password?s(new Error("两次输入的密码不一致")):s()},trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"blur"}]}),h=()=>{_.value&&_.value.validate(m=>{if(m)i.value=!0,F.post("https://register-fyoxpel6ba-uc.a.run.app",a).then(e=>{console.log("注册成功:",e.data),i.value=!1,q({title:"成功",message:"注册成功",type:"success"}),f.value="login"}).catch(e=>{i.value=!1,q({title:"失败",message:"注册失败，请检查输入的信息",type:"error"}),console.error("注册失败:",e)});else return console.log("error submit!!"),!1})};return(m,e)=>{const s=n("el-input"),t=n("el-form-item"),d=n("el-option"),b=n("el-select"),v=n("el-button"),w=n("el-form"),V=n("el-tab-pane"),N=n("el-tabs"),L=S("loading");return y(),T("div",H,[D((y(),I(N,{modelValue:f.value,"onUpdate:modelValue":e[7]||(e[7]=r=>f.value=r),onTabClick:k},{default:o(()=>[l(V,{label:"Login",name:"login"},{default:o(()=>[l(w,{model:u,rules:C,ref_key:"loginFormRef",ref:c,class:"login-form"},{default:o(()=>[l(t,{prop:"email"},{default:o(()=>[l(s,{modelValue:u.email,"onUpdate:modelValue":e[0]||(e[0]=r=>u.email=r),placeholder:"email"},null,8,["modelValue"])]),_:1}),l(t,{prop:"password"},{default:o(()=>[l(s,{type:"password",modelValue:u.password,"onUpdate:modelValue":e[1]||(e[1]=r=>u.password=r),placeholder:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(t,{prop:"role"},{default:o(()=>[l(b,{modelValue:u.role,"onUpdate:modelValue":e[2]||(e[2]=r=>u.role=r),placeholder:"role"},{default:o(()=>[l(d,{label:"admin",value:"admin"}),l(d,{label:"user",value:"user"})]),_:1},8,["modelValue"])]),_:1}),l(t,null,{default:o(()=>[l(v,{type:"primary",onClick:E},{default:o(()=>e[8]||(e[8]=[R("Login")])),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1}),l(V,{label:"Register",name:"register"},{default:o(()=>[l(w,{model:a,rules:P,ref_key:"registerFormRef",ref:_,class:"register-form"},{default:o(()=>[l(t,{prop:"email"},{default:o(()=>[l(s,{modelValue:a.email,"onUpdate:modelValue":e[3]||(e[3]=r=>a.email=r),placeholder:"email"},null,8,["modelValue"])]),_:1}),l(t,{prop:"password"},{default:o(()=>[l(s,{type:"password",modelValue:a.password,"onUpdate:modelValue":e[4]||(e[4]=r=>a.password=r),placeholder:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(t,{prop:"confirmPassword"},{default:o(()=>[l(s,{type:"password",modelValue:a.confirmPassword,"onUpdate:modelValue":e[5]||(e[5]=r=>a.confirmPassword=r),placeholder:"confirm Password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(t,{prop:"role"},{default:o(()=>[l(b,{modelValue:a.role,"onUpdate:modelValue":e[6]||(e[6]=r=>a.role=r),placeholder:"role"},{default:o(()=>[l(d,{label:"admin",value:"admin"}),l(d,{label:"user",value:"user"})]),_:1},8,["modelValue"])]),_:1}),l(t,null,{default:o(()=>[l(v,{type:"primary",onClick:h},{default:o(()=>e[9]||(e[9]=[R("Register")])),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["modelValue"])),[[L,i.value]])])}}},A=B(J,[["__scopeId","data-v-d65cae4a"]]);export{A as default};
